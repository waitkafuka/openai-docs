import{_ as e,c as l,C as a,a as s,I as p,V as o,o as t,J as r}from"./chunks/framework.61392f5d.js";const g=JSON.parse('{"title":"语音转文字","description":"","frontmatter":{},"headers":[],"relativePath":"guides/speech-to-text.md","filePath":"guides/speech-to-text.md","lastUpdated":null}'),c={name:"guides/speech-to-text.md"},i={id:"语音转文字",tabindex:"-1"},y=a("a",{class:"header-anchor",href:"#语音转文字","aria-label":'Permalink to "语音转文字 <Badge text="beta" type="tip"/>"'},"​",-1),D=o(`<p>学习如何将音频转换为文本</p><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>语音转文本 API 提供了基于我们最先进的开源大型 v2 <a href="https://openai.com/blog/whisper/" target="_blank" rel="noreferrer">Whisper 模型</a>的 <code>transcriptions</code> 和 <code>translations</code> 两个终点。它们可以用于：</p><ul><li>将音频转录成音频所在的任何语言。</li><li>将音频翻译并转录成英语。</li></ul><p>文件上传目前限制为 25 MB，支持以下输入文件类型：mp3，mp4，mpeg，mpga，m4a，wav 和 webm。</p><h2 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h2><h3 id="转录" tabindex="-1">转录 <a class="header-anchor" href="#转录" aria-label="Permalink to &quot;转录&quot;">​</a></h3><p>转录 API 将您要转录的音频文件和音频转录的所需输出文件格式作为输入。我们目前支持多种输入和输出文件格式。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-ta8sf" id="tab-K-NfXhL" checked="checked"><label for="tab-K-NfXhL">bash</label><input type="radio" name="group-ta8sf" id="tab-L8cc_XF"><label for="tab-L8cc_XF">python</label></div><div class="blocks"><div class="language-bash active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--request</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POST</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--url</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://api.openai.com/v1/audio/transcriptions</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--header</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Authorization: Bearer TOKEN</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--header</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type: multipart/form-data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--form</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">file=@/path/to/file/openai.mp3</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--form</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">model=whisper-1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 注意：你需要使用 OpenAI Python v0.27.0 使下面的代码工作</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> openai</span></span>
<span class="line"><span style="color:#A6ACCD;">audio_file</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/path/to/file/audio.mp3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">rb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">transcript </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> openai</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Audio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">transcribe</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">whisper-1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> audio_file</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div></div><p>默认情况下，响应类型将是 json，并包括原始文本。</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">text</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Imagine the wildest idea that you&#39;ve ever had, and you&#39;re curious about how it might scale to something that&#39;s a 100, a 1,000 times bigger.</span></span>
<span class="line"><span style="color:#C3E88D;">....</span></span>
<span class="line"><span style="color:#C3E88D;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>要在请求中设置其他参数，可以添加更多的 <code>--form</code> 行以及相关选项。例如，如果您想将输出格式设置为文本，可以添加以下行：</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">--form file=@openai.mp3 \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--form model=whisper-1 \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--form response_format=text</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="翻译" tabindex="-1">翻译 <a class="header-anchor" href="#翻译" aria-label="Permalink to &quot;翻译&quot;">​</a></h2><p>翻译 API 将任何支持的语言的音频文件作为输入，并在必要时将音频转录成英语。这与我们的/转录端点不同，因为输出不是原始输入语言而是被翻译成英语文本。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-h0mzU" id="tab-3HHUDQ9" checked="checked"><label for="tab-3HHUDQ9">python</label><input type="radio" name="group-h0mzU" id="tab-kmsmDBt"><label for="tab-kmsmDBt">bash</label></div><div class="blocks"><div class="language-python active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 注意：你需要使用 OpenAI Python v0.27.0 才能使下面的代码工作</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> openai</span></span>
<span class="line"><span style="color:#A6ACCD;">audio_file </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">open</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/path/to/file/german.mp3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">rb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">transcript </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> openai</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">Audio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">translate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">whisper-1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> audio_file</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--request</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POST</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">--url</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://api.openai.com/v1/audio/translations</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">--header</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Authorization: Bearer TOKEN</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">--header</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type: multipart/form-data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">--form</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">file=@/path/to/file/german.mp3</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">--form</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">model=whisper-1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div></div><p>在这种情况下，输入的音频是德语，输出的文本如下：</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Hello, my name is Wolfgang and I come from Germany. Where are you heading today?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>我们目前仅支持将翻译成英语。</p><h2 id="支持的语言" tabindex="-1">支持的语言 <a class="header-anchor" href="#支持的语言" aria-label="Permalink to &quot;支持的语言&quot;">​</a></h2><p>我们目前通过转录和翻译终点<a href="https://github.com/openai/whisper#available-models-and-languages" target="_blank" rel="noreferrer">支持以下语言</a>：</p><p>南非荷兰语，阿拉伯语，亚美尼亚语，阿塞拜疆语，白俄罗斯语，波斯尼亚语，保加利亚语，加泰罗尼亚语，中文，克罗地亚语，捷克语，丹麦语，荷兰语，英语，爱沙尼亚语，芬兰语，法语，加利西亚语，德语，希腊语，希伯来语，印地语，匈牙利语，冰岛语，印度尼西亚语，意大利语，日语，卡纳达语，哈萨克语，韩语，拉脱维亚语，立陶宛语，马其顿语，马来语，马拉地语，毛利语，尼泊尔语，挪威语，波斯语，波兰语，葡萄牙语，罗马尼亚语，俄语，塞尔维亚语，斯洛伐克语，斯洛文尼亚语，西班牙语，斯瓦希里语，瑞典语，他加禄语，泰米尔语，泰语，土耳其语，乌克兰语，乌尔都语，越南语和威尔士语。</p><p>虽然基础模型是在 98 种语言上进行训练的，但我们只列出了超过&lt;50％的单词<a href="https://en.wikipedia.org/wiki/Word_error_rate" target="_blank" rel="noreferrer">错误率</a>（WER），这是语音转文本模型准确性的行业标准基准。该模型将返回未列在上述语言中的语言的结果，但其质量将较低。</p><h2 id="更长的输入" tabindex="-1">更长的输入 <a class="header-anchor" href="#更长的输入" aria-label="Permalink to &quot;更长的输入&quot;">​</a></h2><p>默认情况下，Whisper API 仅支持小于 25 MB 的文件。如果您有一个大于该文件长度的音频文件，则需要将其分成 25 MB 或更小的块或使用压缩的音频格式。为获得最佳性能，请避免在音频中间断断续续地断开音频，因为这可能会导致某些上下文丢失。</p><p>处理此问题的一种方法是使用 <a href="https://github.com/jiaaro/pydub" target="_blank" rel="noreferrer">PyDub 开源 Python 包</a>拆分音频：</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> pydub </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> AudioSegment</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">song </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> AudioSegment</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">from_mp3</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">good_morning.mp3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># PyDub 以毫秒为时间单位</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ten</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">minutes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">_ 1000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">first_10_minutes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> song</span><span style="color:#89DDFF;">[:</span><span style="color:#A6ACCD;">ten_minutes</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">first_10_minutes</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">export</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">good_morning_10.mp3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">format</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mp3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><em>OpenAI 不保证 PyDub 等第三方软件的可用性或安全性。</em></p><h2 id="提示" tabindex="-1">提示 <a class="header-anchor" href="#提示" aria-label="Permalink to &quot;提示&quot;">​</a></h2><p>您可以使用 <a href="https://platform.openai.com/docs/api-reference/audio/create#audio/create-prompt" target="_blank" rel="noreferrer">prompt</a> 来提高 Whisper API 生成的转录质量。该模型将尝试匹配提示的样式，因此如果提示也使用大写字母和标点符号，它将更有可能使用它们。但是，当前的提示系统比我们的其他语言模型要受到限制，并且仅提供有限的对生成音频的控制。以下是提示在不同场景下如何帮助的一些示例：</p><ol><li>提示可以非常有帮助，用于更正模型在音频中经常错误识别的特定单词或缩写词。例如，以下提示改进了 DALL·E 和 GPT-3 的转录，之前将其写成“GDP 3”和“DALI”。</li></ol><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">The transcript is about OpenAI which makes technology like DALL·E, GPT-3, and ChatGPT with the hope of one day building an AGI system that benefits all of humanity</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li><p>为了保留已分成段的文件的上下文，您可以使用上一段的转录提示模型。这将使转录更准确，因为模型将使用前一个音频的相关信息。模型仅考虑提示的最后 224 个令牌，忽略之前的任何内容。</p></li><li><p>有时，模型在转录中可能会跳过标点符号。您可以使用一个包含标点符号的简单提示来避免出现这种情况：</p></li></ol><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Hello, welcome to my lecture.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="4"><li>模型可能在音频中留下常见的充数词汇。如果您想在转录中保留填充词，请使用包含它们的提示：</li></ol><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Umm, let me think like, hmm... Okay, here&#39;s what I&#39;m, like, thinking.&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="5"><li>某些语言可以用不同的方式书写，例如简体或繁体中文。该模型可能不始终使用您想要的书写风格进行转录。通过使用首选书写风格的提示来改善此情况。</li></ol>`,37);function d(u,m,C,b,h,F){const n=r("Badge");return t(),l("div",null,[a("h1",i,[s("语音转文字 "),p(n,{text:"beta",type:"tip"}),s(),y]),D])}const f=e(c,[["render",d]]);export{g as __pageData,f as default};
